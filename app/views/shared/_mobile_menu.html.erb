<div class="hidden bg-indigo-800 border-t border-indigo-500 md:hidden" data-mobile-menu-target="menu">
  <nav class="px-4 pt-2 pb-4 space-y-1">
    <%# Primary Navigation Links %>
    <a href="/categories" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
      Categories
    </a>
    <a href="/new-arrivals" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
      New Arrivals
    </a>
    <a href="/best-sellers" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
      Best Sellers
    </a>
    <a href="<%= stores_path %>" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
      Stores
    </a>
    <a href="/deals" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
      Deals
    </a>
    <a href="/blog" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
      Blog
    </a>
    <a href="/tutorials" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
      Tutorials
    </a>

    <% if current_user && !current_user.is_a?(Array) && current_user.seller.present? %>
      <a href="/sellers/dashboard" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Sell
      </a>
    <% end %>

    <% if current_user && !current_user.is_a?(Array) %>
      <%# User Account Section - for logged in users %>
      <div class="border-t border-indigo-700 my-2 pt-2">
        <div class="flex items-center px-3 py-2">
          <% if current_user.profile_picture.present? %>
            <%= image_tag current_user.profile_picture, class: "h-8 w-8 rounded-full mr-2" %>
          <% else %>
            <div class="h-8 w-8 rounded-full bg-indigo-600 flex items-center justify-center text-white text-sm font-semibold mr-2">
              <%= current_user.first_name.first.upcase %><%= current_user.last_name.first.upcase %>
            </div>
          <% end %>
          <div>
            <div class="text-white font-medium">
              <%= current_user.first_name %> <%= current_user.last_name %>
            </div>
            <div class="text-indigo-300 text-xs">
              <% if current_user.super_admin? %>
                <span class="px-1.5 py-0.5 bg-red-500 text-white text-xs font-semibold rounded">Super Admin</span>
              <% elsif current_user.admin? %>
                <span class="px-1.5 py-0.5 bg-blue-500 text-white text-xs font-semibold rounded">Admin</span>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <%# Common User Account Links %>
      <a href="/account/profile" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        My Profile
      </a>
      <a href="/account/orders" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Orders
      </a>
      <a href="/account/downloads" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Downloads
      </a>
      <a href="/account/wishlist" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Wishlist
      </a>
      <a href="/notifications" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Notifications
        <span class="ml-1 px-2 py-0.5 bg-yellow-400 text-indigo-900 text-xs font-bold rounded-full">2</span>
      </a>

      <%# Seller Section - if user is a seller %>
      <% if current_user.seller.present? %>
        <div class="border-t border-indigo-700 my-2 pt-2">
          <div class="px-3 py-1">
            <span class="text-xs font-semibold text-indigo-300 uppercase tracking-wider">Seller Dashboard</span>
          </div>
          <a href="/seller/products" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            My Products
          </a>
          <a href="/seller/sales" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Sales Analytics
          </a>
          <a href="/seller/earnings" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Earnings
          </a>
        </div>
      <% end %>

      <%# Admin Section - if user is admin %>
      <% if current_user.admin? %>
        <div class="border-t border-indigo-700 my-2 pt-2">
          <div class="px-3 py-1">
            <span class="text-xs font-semibold text-indigo-300 uppercase tracking-wider">Admin Panel</span>
          </div>
          <a href="/admin/dashboard" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Dashboard
          </a>
          <a href="/admin/users" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Users
          </a>
          <a href="/admin/orders" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Orders
          </a>
          <a href="/admin/products" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Products
          </a>
          <a href="/admin/categories" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Categories
          </a>
        </div>
      <% end %>

      <%# Super Admin Section - if user is super admin %>
      <% if current_user.super_admin? %>
        <div class="border-t border-indigo-700 my-2 pt-2">
          <div class="px-3 py-1">
            <span class="text-xs font-semibold text-indigo-300 uppercase tracking-wider">Super Admin</span>
          </div>
          <a href="/admin/system" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            System Settings
          </a>
          <a href="/admin/security" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Security Settings
          </a>
          <a href="/admin/admins" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Admin Management
          </a>
          <a href="/admin/audit-logs" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Audit Logs
          </a>
          <a href="/admin/payment-security" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
            Payment Security
          </a>
        </div>
      <% end %>

      <%# Common footer links %>
      <div class="border-t border-indigo-700 my-2"></div>
      <a href="/settings" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Settings
      </a>
      <a href="/help-center" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Help & Support
      </a>
      <a href="/logout" data-method="delete" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Logout
      </a>

    <% else %>
      <%# Login/Register Section - for logged out users %>
      <div class="border-t border-indigo-700 my-2"></div>
      <a href="/login" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Login
      </a>
      <a href="/register" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Register
      </a>
      <a href="/help-center" class="block px-3 py-2 rounded-md text-white font-medium hover:bg-indigo-700">
        Help & Support
      </a>
    <% end %>
  </nav>
</div>
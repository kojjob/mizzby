<%# app/views/products/_product_card_minimal.html.erb %>
<div class="group relative">
  <div class="aspect-[3/4] rounded-xl overflow-hidden bg-gray-100 mb-3 relative">
    <%= link_to product_path(product) do %>
      <% if product.product_images.any? && product.product_images.first.image.attached? %>
        <%= image_tag rails_blob_url(product.product_images.first.image), 
            class: "w-full h-full object-cover object-center group-hover:scale-105 transition-transform duration-500",
            loading: "lazy" %>
      <% else %>
        <div class="w-full h-full bg-gray-200 flex items-center justify-center">
          <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
        </div>
      <% end %>
    <% end %>
    
    <%# Wishlist Button %>
    <div class="absolute top-2 right-2 z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
      <% in_wishlist = user_signed_in? && current_user.wishlist_items.exists?(product_id: product.id) %>
      <div data-controller="wishlist-toggle" 
           data-wishlist-toggle-product-id-value="<%= product.id %>"
           data-wishlist-toggle-in-wishlist-value="<%= in_wishlist %>">
        <button data-wishlist-toggle-target="button"
                data-action="click->wishlist-toggle#toggle"
                title="<%= in_wishlist ? 'Remove from Wishlist' : 'Add to Wishlist' %>" 
                class="w-8 h-8 rounded-full bg-white shadow-md flex items-center justify-center <%= in_wishlist ? 'text-red-500' : 'text-gray-500' %> hover:text-red-500 transition-colors">
          <svg data-wishlist-toggle-target="icon" class="w-4 h-4" fill="<%= in_wishlist ? 'currentColor' : 'none' %>" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
          </svg>
        </button>
      </div>
    </div>
    
    <%# Quick Add Button %>
    <div class="absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0">
      <%= button_to add_to_cart_product_path(product), method: :post,
          class: "w-10 h-10 rounded-full bg-white text-gray-900 shadow-lg flex items-center justify-center hover:bg-indigo-600 hover:text-white transition-colors",
          data: { turbo: true } do %>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/></svg>
      <% end %>
    </div>
  </div>
  
  <h4 class="text-sm font-medium text-gray-900 mb-1 truncate group-hover:text-indigo-600 transition-colors">
    <%= link_to product.name, product_path(product) %>
  </h4>
  
  <div class="flex items-baseline gap-2">
    <% if product.discounted_price.present? && product.discounted_price < product.price %>
      <span class="text-sm font-bold text-gray-900"><%= number_to_currency(product.discounted_price) %></span>
      <span class="text-xs text-gray-500 line-through"><%= number_to_currency(product.price) %></span>
    <% else %>
      <span class="text-sm font-bold text-gray-900"><%= number_to_currency(product.price) %></span>
    <% end %>
  </div>
</div>
<% content_for :title, "Discover Stores" %>

<!-- Hero Section -->
<div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white">
  <div class="container mx-auto px-4 py-16 md:py-24">
    <div class="max-w-4xl mx-auto text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-4">Discover Unique Stores</h1>
      <p class="text-xl md:text-2xl opacity-90 mb-8">Find amazing products from our curated collection of independent sellers</p>

      <!-- Search Bar -->
      <div class="relative max-w-2xl mx-auto">
        <form action="<%= stores_path %>" method="get" class="flex">
          <input type="text" name="search" placeholder="Search for stores..."
                 class="w-full px-6 py-4 rounded-l-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-300 text-lg"
                 value="<%= params[:search] %>">
          <button type="submit" class="bg-indigo-800 hover:bg-indigo-900 px-6 py-4 rounded-r-lg transition-colors duration-200">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- Wave Divider -->
  <div class="w-full">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 100" class="w-full h-auto fill-current text-gray-50">
      <path d="M0,64L80,69.3C160,75,320,85,480,80C640,75,800,53,960,42.7C1120,32,1280,32,1360,32L1440,32L1440,100L1360,100C1280,100,1120,100,960,100C800,100,640,100,480,100C320,100,160,100,80,100L0,100Z"></path>
    </svg>
  </div>
</div>

<!-- Main Content -->
<div class="bg-gray-50 min-h-screen pb-16">
  <div class="container mx-auto px-4">
    <!-- Filters and Sorting -->
    <div class="flex flex-col md:flex-row justify-between items-center mb-8 py-4">
      <div class="flex items-center space-x-2 mb-4 md:mb-0">
        <h2 class="text-xl font-semibold text-gray-800">Browse Stores</h2>
        <span class="bg-indigo-100 text-indigo-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">
          <%= @stores.total_count rescue @stores.count %> stores
        </span>
      </div>

      <div class="flex flex-wrap items-center gap-2">
        <!-- Category Filter (if implemented) -->
        <div class="relative">
          <select class="bg-white border border-gray-300 text-gray-700 py-2 px-4 pr-8 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-indigo-300 appearance-none">
            <option>All Categories</option>
            <option>Fashion</option>
            <option>Electronics</option>
            <option>Home & Garden</option>
            <option>Beauty</option>
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
              <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/>
            </svg>
          </div>
        </div>

        <!-- Sort Dropdown -->
        <div class="relative">
          <select onchange="window.location=this.value" class="bg-white border border-gray-300 text-gray-700 py-2 px-4 pr-8 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-indigo-300 appearance-none">
            <option value="<%= stores_path(sort: 'newest') %>" <%= 'selected' if params[:sort] == 'newest' || params[:sort].blank? %>>Newest First</option>
            <option value="<%= stores_path(sort: 'alphabetical') %>" <%= 'selected' if params[:sort] == 'alphabetical' %>>Alphabetical</option>
            <option value="<%= stores_path(sort: 'popular') %>" <%= 'selected' if params[:sort] == 'popular' %>>Most Popular</option>
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
              <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/>
            </svg>
          </div>
        </div>

        <!-- View Toggle -->
        <div class="flex bg-white border border-gray-300 rounded-lg overflow-hidden">
          <button class="px-3 py-2 bg-indigo-600 text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
            </svg>
          </button>
          <button class="px-3 py-2 text-gray-700 hover:bg-gray-100">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Stores Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      <% @stores.each do |store| %>
        <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 flex flex-col h-full group">
          <!-- Store Banner -->
          <div class="relative h-48 overflow-hidden bg-gradient-to-r from-gray-100 to-gray-200">
            <% if store.banner_image.attached? %>
              <%= image_tag store.banner_image.variant(resize_to_fill: [400, 200]),
                           class: 'w-full h-full object-cover transition-transform duration-500 group-hover:scale-105',
                           alt: store.name %>
            <% else %>
              <div class="w-full h-full flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                </svg>
              </div>
            <% end %>

            <!-- Product Count Badge -->
            <div class="absolute top-3 right-3 bg-black bg-opacity-60 text-white text-xs font-medium px-2.5 py-1 rounded-full">
              <%= pluralize(store.products.count, 'product') %>
            </div>
          </div>

          <!-- Store Info -->
          <div class="p-5 flex flex-col flex-grow">
            <!-- Store Logo -->
            <div class="flex items-center mb-4">
              <div class="flex-shrink-0 mr-3">
                <% if store.logo.attached? %>
                  <%= image_tag store.logo.variant(resize_to_limit: [60, 60]),
                               class: 'h-12 w-12 rounded-full object-cover border-2 border-white shadow-sm',
                               alt: "#{store.name} logo" %>
                <% else %>
                  <div class="h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold text-xl">
                    <%= store.name.first.upcase %>
                  </div>
                <% end %>
              </div>

              <div>
                <h3 class="text-lg font-semibold text-gray-900 line-clamp-1"><%= store.name %></h3>
                <p class="text-sm text-gray-500">By <%= store.seller.business_name %></p>
              </div>
            </div>

            <!-- Store Description -->
            <p class="text-gray-600 text-sm mb-4 flex-grow line-clamp-3">
              <%= store.description || "This store hasn't added a description yet." %>
            </p>

            <!-- Store Tags (if implemented) -->
            <div class="flex flex-wrap gap-1 mb-4">
              <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Fashion</span>
              <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Handmade</span>
              <span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Unique</span>
            </div>

            <!-- Store Actions -->
            <div class="flex items-center justify-between mt-auto pt-3 border-t border-gray-100">
              <%= link_to store_path(store.slug), class: "text-indigo-600 hover:text-indigo-800 font-medium text-sm flex items-center" do %>
                Visit Store
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
              <% end %>

              <button class="text-gray-400 hover:text-red-500 focus:outline-none">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                </svg>
              </button>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Empty State -->
    <% if @stores.empty? %>
      <div class="bg-white rounded-xl shadow-sm p-8 text-center my-8">
        <div class="mx-auto w-24 h-24 bg-indigo-100 rounded-full flex items-center justify-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">No stores found</h3>
        <p class="text-gray-600 mb-6">We couldn't find any stores matching your criteria.</p>
        <a href="<%= stores_path %>" class="inline-flex items-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg transition-colors duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
          </svg>
          Reset Filters
        </a>
      </div>
    <% end %>

    <!-- Pagination -->
    <% if @stores.respond_to?(:total_pages) && @stores.total_pages > 1 %>
      <div class="flex justify-center mt-10">
        <nav class="inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
          <!-- Previous Page -->
          <%= link_to_unless_current @stores.prev_page.nil?, url_for(page: @stores.prev_page), class: "relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium #{@stores.prev_page.nil? ? 'text-gray-300 cursor-not-allowed' : 'text-gray-500 hover:bg-gray-50'}" do %>
            <span class="sr-only">Previous</span>
            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
            </svg>
          <% end %>

          <!-- Page Numbers -->
          <% (1..@stores.total_pages).each do |page| %>
            <% if page == @stores.current_page %>
              <span class="relative inline-flex items-center px-4 py-2 border border-indigo-500 bg-indigo-50 text-sm font-medium text-indigo-600">
                <%= page %>
              </span>
            <% else %>
              <%= link_to page, url_for(page: page), class: "relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50" %>
            <% end %>
          <% end %>

          <!-- Next Page -->
          <%= link_to_unless_current @stores.next_page.nil?, url_for(page: @stores.next_page), class: "relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium #{@stores.next_page.nil? ? 'text-gray-300 cursor-not-allowed' : 'text-gray-500 hover:bg-gray-50'}" do %>
            <span class="sr-only">Next</span>
            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
            </svg>
          <% end %>
        </nav>
      </div>
    <% end %>
  </div>
</div>

<!-- Featured Stores Section -->
<section class="bg-white py-16">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">Featured Stores</h2>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">Discover our handpicked selection of exceptional stores</p>
    </div>

    <!-- Featured Stores Carousel -->
    <div class="relative">
      <!-- Carousel Controls -->
      <button class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 bg-white rounded-full p-2 shadow-md z-10 text-gray-800 hover:text-indigo-600 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>

      <div class="overflow-hidden">
        <div class="flex space-x-6 py-4">
          <% @stores.first(5).each do |store| %>
            <div class="flex-shrink-0 w-80 bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300">
              <!-- Store Banner -->
              <div class="h-32 overflow-hidden bg-gradient-to-r from-indigo-500 to-purple-500">
                <% if store.banner_image.attached? %>
                  <%= image_tag store.banner_image.variant(resize_to_fill: [320, 128]),
                               class: 'w-full h-full object-cover',
                               alt: store.name %>
                <% end %>
              </div>

              <!-- Store Info -->
              <div class="p-4">
                <div class="flex items-center mb-3">
                  <% if store.logo.attached? %>
                    <%= image_tag store.logo.variant(resize_to_limit: [48, 48]),
                                 class: 'h-10 w-10 rounded-full object-cover border-2 border-white shadow-sm mr-3',
                                 alt: "#{store.name} logo" %>
                  <% else %>
                    <div class="h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold text-lg mr-3">
                      <%= store.name.first.upcase %>
                    </div>
                  <% end %>

                  <h3 class="text-base font-semibold text-gray-900 truncate"><%= store.name %></h3>
                </div>

                <p class="text-gray-600 text-sm mb-3 line-clamp-2">
                  <%= truncate(store.description || "This store hasn't added a description yet.", length: 80) %>
                </p>

                <%= link_to store_path(store.slug), class: "text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center" do %>
                  Explore Store
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                  </svg>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>

      <button class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 bg-white rounded-full p-2 shadow-md z-10 text-gray-800 hover:text-indigo-600 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
    </div>
  </div>
</section>

<!-- Call to Action Section -->
<section class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-16">
  <div class="container mx-auto px-4 text-center">
    <h2 class="text-3xl font-bold mb-4">Ready to Start Your Own Store?</h2>
    <p class="text-xl opacity-90 mb-8 max-w-2xl mx-auto">Join our marketplace and start selling your products to customers around the world.</p>
    <a href="#" class="inline-flex items-center px-6 py-3 border-2 border-white text-lg font-medium rounded-lg text-white hover:bg-white hover:text-indigo-600 transition-colors duration-200">
      Create Your Store
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
      </svg>
    </a>
  </div>
</section>
